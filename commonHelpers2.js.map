{"version":3,"file":"commonHelpers2.js","sources":["../src/img/error.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__8479b7dd__\"","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport axios from 'axios';\nimport errorSvg from '/img/error.svg';\n\nconst API_BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '41647148-76dbe9dab66bab2692c283b6e';\n\naxios.defaults.baseURL = API_BASE_URL;\n\nlet limit;\n\nconst searchParams = {\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n  per_page: 40,\n  page: 1,\n};\n\nconst simpleGallery = new SimpleLightbox('.gallery a', {\n  overlayOpacity: 0.8,\n  captionsData: 'alt',\n  captionDelay: 500,\n});\n\nconst form = document.querySelector('.gallery-form');\nconst searchInput = document.querySelector('.search-input');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nasync function startSearch(event) {\n  event.preventDefault();\n  if (!searchInput.value.trim()) {\n    showErrorMessage('Please fill in the search field');\n    return;\n  }\n  try {\n    gallery.innerHTML = '';\n    isContentVisible(loader, true);\n    isContentVisible(loadMoreBtn, false);\n    searchParams.q = searchInput.value.trim();\n    searchParams.page = 1;\n    const data = await fetchPhotos();\n    limit = data.totalHits;\n    createGallery(data);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function loadMore() {\n  try {\n    isContentVisible(loader, true);\n    isContentVisible(loadMoreBtn, false);\n    const photos = await fetchPhotos();\n    createGallery(photos);\n  } catch (error) {\n    console.log(error);\n  }\n}\n\nasync function fetchPhotos() {\n  const response = await axios.get('', { params: searchParams });\n  return response.data;\n}\n\nfunction createGallery(photos) {\n  if (!photos.total) {\n    showErrorMessage(\n      'Sorry, there are no images matching your search query. Please, try again!'\n    );\n    isContentVisible(loader, false);\n    return;\n  }\n  const markup = photos.hits\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n        <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n        <img class=\"api-img\" src=\"${webformatURL}\" alt=\"${tags}\">\n        <div class=\"img-desc\">\n        <span><b>Likes:</b> <br/>${likes}</span>\n        <span><b>Views:</b> <br/>${views}</span>\n        <span><b>Comments:</b> <br/>${comments}</span>\n        <span><b>Downloads:</b> <br/>${downloads}</span>\n        </div>\n        </a>\n        </li>\n        `;\n      }\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  isContentVisible(loader, false);\n  checkLimit();\n  scrollPage();\n  simpleGallery.refresh();\n  form.reset();\n}\n\nfunction checkLimit() {\n  if (Math.ceil(limit / searchParams.per_page) === searchParams.page) {\n    showErrorMessage(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n  } else {\n    searchParams.page += 1;\n    isContentVisible(loadMoreBtn, true);\n  }\n}\n\nfunction isContentVisible(content, isVisible) {\n  if (isVisible) {\n    content.classList.remove('hidden');\n  } else {\n    content.classList.add('hidden');\n  }\n}\n\nfunction scrollPage() {\n  if (searchParams.page > 1) {\n    const rect = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect();\n    window.scrollBy({ top: rect.height * 2, left: 0, behavior: 'smooth' });\n  }\n}\n\nfunction showErrorMessage(message) {\n  iziToast.show({\n    position: 'topRight',\n    iconUrl: errorSvg,\n    message,\n    backgroundColor: '#EF4040',\n    messageColor: '#FAFAFB',\n    messageSize: '16px',\n    close: false,\n    closeOnClick: true,\n    closeOnEscape: true,\n  });\n}\n\nform.addEventListener('submit', event => startSearch(event));\n\nloadMoreBtn.addEventListener('click', () => loadMore());\n"],"names":["errorSvg","API_BASE_URL","API_KEY","axios","limit","searchParams","simpleGallery","SimpleLightbox","form","searchInput","gallery","loader","loadMoreBtn","startSearch","event","showErrorMessage","isContentVisible","data","fetchPhotos","createGallery","error","loadMore","photos","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","checkLimit","scrollPage","content","isVisible","rect","message","iziToast"],"mappings":"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"}